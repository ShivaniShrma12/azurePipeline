trigger:
- main

pool:
  name: PipelineAgent
  vmImage: ubuntu-latest

steps:
- task: Maven@4
  displayName: 'Maven clean and verify'
  inputs:
    mavenPomFile: 'pom.xml'
    goals: 'clean verify'
    options: '-Dcucumber.filter.tags="@ECOM_LoginTC_207 or @ECOM_LoginTC_231"'
   
- task: CopyFiles@2
  displayName: 'Copy Cucumber reports'
  inputs:
    SourceFolder: '$(System.DefaultWorkingDirectory)/ExecutionReports'
    Contents: '**'
    TargetFolder: '$(Build.ArtifactStagingDirectory)/CucumberReports'

- task: PublishBuildArtifacts@1
  displayName: 'Publish Cucumber reports as artifacts'
  inputs:
    PathtoPublish: '$(Build.ArtifactStagingDirectory)/CucumberReports'
    ArtifactName: 'CucumberReports'

- task: PublishPipelineArtifact@1
  displayName: 'Publish Artifacts'
  inputs:
    targetPath: '$(Build.ArtifactStagingDirectory)'
    artifact: 'CucumberReports'
{"version":3,"file":"background.js","mappings":";;;;;;;;;;AAAa;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,iBAAiB,GAAG,YAAY;AAChC,YAAY;AACZ;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;;;;;;;;;;;ACVa;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAe;;;;;;;;;;;ACVF;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB,kBAAe;;;;;;;;;;;ACjBF;AACb;AACA,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA;AACA,6CAA6C;AAC7C;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,WAAW,GAAG,2BAA2B,GAAG,oBAAoB,GAAG,mBAAmB,GAAG,YAAY;AACrG,0CAA0C,mBAAO,CAAC,6DAAwB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;AACA,CAAC;AACD,YAAY;AACZ;AACA;AACA;AACA,8CAA8C;AAC9C,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,CAAC;AACD,2BAA2B;AAC3B;AACA;AACA;AACA,KAAK;AACL;AACA,CAAC;AACD,WAAW;;;;;;;;;;;ACnEE;AACb;AACA,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA;AACA,6CAA6C;AAC7C;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,eAAe;AACf,kBAAkB,mBAAO,CAAC,uDAAqB;AAC/C,0CAA0C,mBAAO,CAAC,6DAAwB;AAC1E,sCAAsC,mBAAO,CAAC,qDAAoB;AAClE,yBAAyB,mBAAO,CAAC,iEAA0B;AAC3D;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,+BAA+B,YAAY,WAAW;AACtD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,wBAAwB;AACjD;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,qBAAqB,WAAW;AACnE;AACA,2BAA2B,eAAe;AAC1C,SAAS;AACT;AACA;AACA;AACA,4GAA4G;AAC5G,2BAA2B,uBAAuB;AAClD,SAAS;AACT;AACA;AACA;AACA,6BAA6B,8BAA8B;AAC3D;AACA;AACA;AACA,8HAA8H,oBAAoB;AAClJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,iBAAiB,WAAW;AAC/D,KAAK;AACL,CAAC;AACD;AACA,+BAA+B,oBAAoB,WAAW;AAC9D,+BAA+B,sBAAsB,WAAW;AAChE,+BAA+B,YAAY,WAAW;AACtD;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,mBAAmB,WAAW;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,eAAe;;;;;;;UClIf;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;UEtBA;UACA;UACA;UACA","sources":["webpack://chrome-extension-4.0-alpha/./src/constants/apiUrls.ts","webpack://chrome-extension-4.0-alpha/./src/data/ExecutionDetail.ts","webpack://chrome-extension-4.0-alpha/./src/data/UiPathEvent.ts","webpack://chrome-extension-4.0-alpha/./src/helpers/downloadHelper.ts","webpack://chrome-extension-4.0-alpha/./src/scripts/background.ts","webpack://chrome-extension-4.0-alpha/webpack/bootstrap","webpack://chrome-extension-4.0-alpha/webpack/before-startup","webpack://chrome-extension-4.0-alpha/webpack/startup","webpack://chrome-extension-4.0-alpha/webpack/after-startup"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.endpoints = exports.urls = void 0;\r\nexports.urls = {\r\n    local: 'http://localhost:3000/api',\r\n    server: 'http://192.168.6.207/api',\r\n};\r\nexports.endpoints = {\r\n    xaml: '/UiPathXamlCoverter',\r\n    execution: '/execution-detail',\r\n};\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass ExecutionDetails {\r\n    constructor(pageTitle, scriptName, imageDataUri, xamlName) {\r\n        this.imageUri = imageDataUri;\r\n        this.pageTitle = pageTitle;\r\n        this.scriptName = scriptName;\r\n        this.xamlName = xamlName;\r\n    }\r\n}\r\nexports.default = ExecutionDetails;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.UiPathEvent = void 0;\r\nclass UiPathEvent {\r\n    constructor() {\r\n        this.pageTitle = '';\r\n        this.pageUrl = '';\r\n        this.css = null;\r\n        this.eventType = '';\r\n        this.aaname = '';\r\n        this.keys = [];\r\n        this.modifierKey = '';\r\n        this.isIFrame = false;\r\n        this.isTwoKey = false;\r\n    }\r\n}\r\nexports.UiPathEvent = UiPathEvent;\r\nexports.default = UiPathEvent;\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.get = exports.postExecutionDetail = exports.objectToJson = exports.downloadXML = exports.post = void 0;\r\nconst ExecutionDetail_1 = __importDefault(require(\"@/data/ExecutionDetail\"));\r\nconst post = (url, data) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const response = yield fetch(url, {\r\n        method: 'POST',\r\n        mode: 'cors',\r\n        cache: 'no-cache',\r\n        credentials: 'same-origin',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n        },\r\n        redirect: 'follow',\r\n        referrerPolicy: 'no-referrer',\r\n        body: data,\r\n    });\r\n    return response.text();\r\n});\r\nexports.post = post;\r\nconst downloadXML = (XMLdata) => {\r\n    const fileName = new Date().toISOString();\r\n    let link = document.createElement('a');\r\n    link.setAttribute('style', 'display: none;');\r\n    let data = 'text/json;charset=utf-8,' + encodeURIComponent(XMLdata);\r\n    link.setAttribute('href', 'data:' + data);\r\n    link.setAttribute('download', fileName + '.xaml');\r\n    link.click();\r\n    setTimeout(function () {\r\n        link.remove();\r\n    }, 200);\r\n    return fileName;\r\n};\r\nexports.downloadXML = downloadXML;\r\nconst objectToJson = (steps) => {\r\n    if (Object.keys(steps).length > 0) {\r\n        return JSON.stringify(steps);\r\n    }\r\n    return null;\r\n};\r\nexports.objectToJson = objectToJson;\r\nconst postExecutionDetail = (fileName, url, scriptName) => __awaiter(void 0, void 0, void 0, function* () {\r\n    chrome.storage.local.get(['firstPage'], (result) => {\r\n        const requestInput = new ExecutionDetail_1.default(result.firstPage.title, scriptName ? scriptName : 'Manual', result.firstPage.uri, fileName);\r\n        const data = (0, exports.objectToJson)(requestInput);\r\n        (0, exports.post)(url, data);\r\n    });\r\n});\r\nexports.postExecutionDetail = postExecutionDetail;\r\nconst get = (url) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const response = yield fetch(url, {\r\n        method: 'GET',\r\n    });\r\n    return response.text();\r\n});\r\nexports.get = get;\r\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.postLog = void 0;\r\nconst apiUrls_1 = require(\"@/constants/apiUrls\");\r\nconst ExecutionDetail_1 = __importDefault(require(\"@/data/ExecutionDetail\"));\r\nconst UiPathEvent_1 = __importDefault(require(\"@/data/UiPathEvent\"));\r\nconst downloadHelper_1 = require(\"@/helpers/downloadHelper\");\r\nconst server = apiUrls_1.urls.server;\r\nchrome.runtime.onInstalled.addListener(() => {\r\n    console.log('Installed');\r\n});\r\nchrome.runtime.onStartup.addListener(() => __awaiter(void 0, void 0, void 0, function* () {\r\n    chrome.storage.local.clear();\r\n    chrome.storage.local.set({ events: [] }, () => { });\r\n    const tab = yield getActiveTab();\r\n}));\r\nconst downloadXamlFromAPI = () => __awaiter(void 0, void 0, void 0, function* () {\r\n    return new Promise((resolve, reject) => {\r\n        const events = [];\r\n        const storedEvents = [];\r\n        chrome.storage.local.get(['events'], (result) => {\r\n            const pendingEvents = result.events;\r\n            if (result.events)\r\n                events.push(...pendingEvents);\r\n        });\r\n        chrome.storage.local.get(['jsonObject'], (result) => {\r\n            storedEvents.push(...result.jsonObject);\r\n            if (events.length > 0) {\r\n                storedEvents.push(events);\r\n            }\r\n            const data = (0, downloadHelper_1.objectToJson)(storedEvents);\r\n            if (data) {\r\n                convertJSONtoXAML(data)\r\n                    .then((xml) => resolve(xml))\r\n                    .catch(reject);\r\n            }\r\n            else {\r\n                reject({ error: 'No data found' });\r\n            }\r\n        });\r\n        const convertJSONtoXAML = (jsonData) => {\r\n            return (0, downloadHelper_1.post)(server + apiUrls_1.endpoints.xaml, jsonData);\r\n        };\r\n    });\r\n});\r\nchrome.runtime.onMessage.addListener((request, sender, sendResponse) => {\r\n    var _a;\r\n    if (request.capture === 'startCapture') {\r\n        startCapture(sender.tab);\r\n        return true;\r\n    }\r\n    if (request.capture === 'stopCapture') {\r\n        chrome.storage.local.set({ captureStart: false }, () => { });\r\n        downloadXamlFromAPI().then((xmlData) => {\r\n            sendResponse({ data: xmlData });\r\n        });\r\n        return true;\r\n    }\r\n    if (request.message === 'screenshot') {\r\n        chrome.tabs.captureVisibleTab((_a = sender.tab) === null || _a === void 0 ? void 0 : _a.windowId, {}, (dataUrl) => {\r\n            sendResponse({ imageDataUrl: dataUrl });\r\n        });\r\n        return true;\r\n    }\r\n    if (request.message === 'logs') {\r\n        chrome.tabs.create({ url: 'execution.detail.html' });\r\n        return true;\r\n    }\r\n    if (request.message === 'executionDetail') {\r\n        (0, downloadHelper_1.postExecutionDetail)(request.fileName, apiUrls_1.urls.server + apiUrls_1.endpoints.execution, `${request.scriptName} - Selenium`);\r\n        chrome.storage.local.clear();\r\n        return true;\r\n    }\r\n    if (request.message === 'postLogs') {\r\n        (0, exports.postLog)(apiUrls_1.urls.server + apiUrls_1.endpoints.execution, request.title, request.url);\r\n        return true;\r\n    }\r\n});\r\nconst saveFirstPageDetails = (tab) => __awaiter(void 0, void 0, void 0, function* () {\r\n    chrome.tabs.captureVisibleTab((imageDataUrl) => {\r\n        const data = {\r\n            uri: imageDataUrl,\r\n            title: tab.title,\r\n            fileName: '',\r\n        };\r\n        chrome.storage.local.set({ firstPage: data }, () => { });\r\n    });\r\n});\r\nconst startCapture = (tab) => {\r\n    chrome.storage.local.set({ captureStart: true }, () => { });\r\n    chrome.storage.local.set({ debounceTimeout: 500 }, () => { });\r\n    chrome.storage.local.set({ events: [] }, () => { });\r\n    const steps = [];\r\n    const events = [];\r\n    const eventObject = createFirstPageEventObject(tab);\r\n    events.push(eventObject);\r\n    steps.push(events);\r\n    saveFirstPageDetails(tab);\r\n    chrome.storage.local.set({ jsonObject: steps }, () => { });\r\n};\r\nconst createFirstPageEventObject = (tab) => {\r\n    const eventObject = new UiPathEvent_1.default();\r\n    eventObject.pageTitle = tab.title;\r\n    eventObject.pageUrl = tab.url;\r\n    eventObject.eventType = 'OpenBrowser';\r\n    return eventObject;\r\n};\r\nconst getActiveTab = () => __awaiter(void 0, void 0, void 0, function* () {\r\n    const queryOptions = { active: true, currentWindow: true };\r\n    const [tab] = yield chrome.tabs.query(queryOptions);\r\n    return tab;\r\n});\r\nconst postLog = (url, pageTitle, scriptName) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const detail = new ExecutionDetail_1.default(pageTitle, scriptName ? scriptName : 'Manual', '', '');\r\n    const req = (0, downloadHelper_1.objectToJson)(detail);\r\n    console.log(req);\r\n    yield (0, downloadHelper_1.post)(url, req);\r\n});\r\nexports.postLog = postLog;\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/scripts/background.ts\");\n",""],"names":[],"sourceRoot":""}